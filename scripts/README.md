# Scripts è¯´æ˜æ–‡æ¡£

æœ¬ç›®å½•åŒ…å«ç”¨äºéƒ¨ç½²å’Œç»´æŠ¤çš„è„šæœ¬å·¥å…·ã€‚

## ğŸ“¦ OSS ç›¸å…³è„šæœ¬

### upload-to-oss.js

å°† Next.js æ„å»ºåçš„é™æ€èµ„æºä¸Šä¼ åˆ°é˜¿é‡Œäº‘ OSSã€‚

**åŠŸèƒ½**ï¼š
- ä¸Šä¼  `.next/static` ç›®å½•åˆ° OSS
- å¯é€‰ä¸Šä¼  `public` ç›®å½•
- è‡ªåŠ¨è®¾ç½®æ­£ç¡®çš„ Content-Type
- è®¾ç½®æ–‡ä»¶ä¸ºå…¬å…±è¯»å–
- æ˜¾ç¤ºä¸Šä¼ è¿›åº¦å’Œç»Ÿè®¡

**ä½¿ç”¨æ–¹æ³•**ï¼š

```bash
# åªä¸Šä¼  .next/static ç›®å½•
node scripts/upload-to-oss.js

# åŒæ—¶ä¸Šä¼  public ç›®å½•
node scripts/upload-to-oss.js --public

# ä½¿ç”¨ npm scriptsï¼ˆæ¨èï¼‰
pnpm run upload:oss
pnpm run upload:oss:all  # åŒ…å« public ç›®å½•
```

**ç¯å¢ƒå˜é‡**ï¼š

éœ€è¦åœ¨ `.env.production` ä¸­é…ç½®ï¼š

```env
OSS_ACCESS_KEY_ID=your_access_key_id
OSS_ACCESS_KEY_SECRET=your_access_key_secret
OSS_REGION=oss-cn-hangzhou
OSS_BUCKET=your-bucket-name
NEXT_PUBLIC_CDN_URL=https://cdn.brainco.com
```

**è¾“å‡ºç¤ºä¾‹**ï¼š

```
ğŸš€ å¼€å§‹ä¸Šä¼ é™æ€èµ„æºåˆ° OSS
==================================================
ğŸ“¦ Bucket: brainco-website-static
ğŸŒ Region: oss-cn-hangzhou
==================================================

ğŸ“¦ å¼€å§‹ä¸Šä¼ ç›®å½•: .next/static
ğŸ“ OSS è·¯å¾„å‰ç¼€: _next/static
ğŸ“„ å…±æ‰¾åˆ° 156 ä¸ªæ–‡ä»¶

[1/156] ä¸Šä¼ ä¸­: chunks/main-xxxxx.js (245.67 KB)... âœ…
[2/156] ä¸Šä¼ ä¸­: chunks/framework-xxxxx.js (42.13 KB)... âœ…
...

==================================================
ğŸ“Š ä¸Šä¼ ç»Ÿè®¡
==================================================
âœ… æˆåŠŸ: 156 ä¸ªæ–‡ä»¶
âŒ å¤±è´¥: 0 ä¸ªæ–‡ä»¶
ğŸ“¦ æ€»è®¡: 156 ä¸ªæ–‡ä»¶
â±ï¸  è€—æ—¶: 23.45 ç§’
==================================================

ğŸ‰ æ‰€æœ‰æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼
```

### clear-oss-cache.js

æ¸…ç† OSS ä¸Šçš„æ—§ç‰ˆæœ¬é™æ€èµ„æºï¼ŒèŠ‚çœå­˜å‚¨ç©ºé—´ã€‚

**åŠŸèƒ½**ï¼š
- åˆ—å‡ºæ‰€æœ‰æ„å»ºç‰ˆæœ¬
- ä¿ç•™æœ€è¿‘ N ä¸ªç‰ˆæœ¬ï¼ˆé»˜è®¤ 3ï¼‰
- åˆ é™¤æ—§ç‰ˆæœ¬æ–‡ä»¶
- æ”¯æŒ dry-run æ¨¡å¼é¢„è§ˆ

**ä½¿ç”¨æ–¹æ³•**ï¼š

```bash
# æ¸…ç†æ—§ç‰ˆæœ¬ï¼Œä¿ç•™æœ€è¿‘ 3 ä¸ª
node scripts/clear-oss-cache.js

# ä¿ç•™æœ€è¿‘ 5 ä¸ªç‰ˆæœ¬
node scripts/clear-oss-cache.js --keep=5

# é¢„è§ˆæ¨¡å¼ï¼ˆä¸å®é™…åˆ é™¤ï¼‰
node scripts/clear-oss-cache.js --dry-run

# ä½¿ç”¨ npm scripts
pnpm run clean:oss        # ä¿ç•™ 3 ä¸ªç‰ˆæœ¬
pnpm run clean:oss:dry    # é¢„è§ˆæ¨¡å¼
```

**è¾“å‡ºç¤ºä¾‹**ï¼š

```
ğŸ§¹ å¼€å§‹æ¸…ç† OSS æ—§ç‰ˆæœ¬æ–‡ä»¶
==================================================
ğŸ“¦ Bucket: brainco-website-static
ğŸŒ Region: oss-cn-hangzhou
ğŸ”¢ ä¿ç•™ç‰ˆæœ¬æ•°: 3
ğŸ” æ¨¡å¼: å®é™…åˆ é™¤
==================================================

ğŸ“‹ æ­£åœ¨åˆ—å‡ºæ–‡ä»¶...
âœ… æ‰¾åˆ° 468 ä¸ªæ–‡ä»¶

ğŸ” æ‰¾åˆ° 5 ä¸ªæ„å»ºç‰ˆæœ¬:
  âœ… ä¿ç•™ - abc123def456 (2024-11-27 15:30:00)
  âœ… ä¿ç•™ - xyz789uvw012 (2024-11-27 12:00:00)
  âœ… ä¿ç•™ - mno345pqr678 (2024-11-26 18:45:00)
  ğŸ—‘ï¸  åˆ é™¤ - stu901vwx234 (2024-11-25 14:20:00)
  ğŸ—‘ï¸  åˆ é™¤ - abc567def890 (2024-11-24 10:15:00)

ğŸ—‘ï¸  å‡†å¤‡åˆ é™¤ 187 ä¸ªæ–‡ä»¶
âœ… å·²åˆ é™¤ 187/187 ä¸ªæ–‡ä»¶

ğŸ‰ æ¸…ç†å®Œæˆï¼

ğŸ“Š æ¸…ç†å®Œæˆç»Ÿè®¡:
   åˆ é™¤æ–‡ä»¶: 187 ä¸ª
   ä¿ç•™æ–‡ä»¶: 281 ä¸ª
```

## ğŸ”§ å…¶ä»–è„šæœ¬

### generate-sitemap.mjs

ç”Ÿæˆç½‘ç«™åœ°å›¾ã€‚

```bash
node scripts/generate-sitemap.mjs
```

### check-seo-pages.mjs

æ£€æŸ¥ SEO é…ç½®ã€‚

```bash
node scripts/check-seo-pages.mjs
```

### lighthouse-audit.js

è¿è¡Œ Lighthouse æ€§èƒ½å®¡è®¡ã€‚

```bash
node scripts/lighthouse-audit.js
```

## ğŸ“ å¼€å‘æ–°è„šæœ¬

åœ¨å¼€å‘æ–°è„šæœ¬æ—¶ï¼Œè¯·éµå¾ªä»¥ä¸‹è§„èŒƒï¼š

1. **æ–‡ä»¶å¤´æ³¨é‡Š**ï¼šè¯´æ˜è„šæœ¬åŠŸèƒ½ã€ä½¿ç”¨æ–¹æ³•ã€å‚æ•°
2. **é”™è¯¯å¤„ç†**ï¼šå®Œå–„çš„é”™è¯¯æç¤ºå’Œå¤„ç†
3. **è¿›åº¦æ˜¾ç¤º**ï¼šé•¿æ—¶é—´è¿è¡Œçš„è„šæœ¬æ˜¾ç¤ºè¿›åº¦
4. **å‚æ•°éªŒè¯**ï¼šéªŒè¯å¿…éœ€çš„ç¯å¢ƒå˜é‡å’Œå‚æ•°
5. **è¾“å‡ºæ ¼å¼**ï¼šä½¿ç”¨è¡¨æƒ…ç¬¦å·å’Œæ ¼å¼åŒ–è¾“å‡º
6. **é€€å‡ºä»£ç **ï¼šæˆåŠŸè¿”å› 0ï¼Œå¤±è´¥è¿”å› 1

### ç¤ºä¾‹æ¨¡æ¿

```javascript
#!/usr/bin/env node

/**
 * è„šæœ¬åç§°å’ŒåŠŸèƒ½è¯´æ˜
 * 
 * ä½¿ç”¨æ–¹æ³•ï¼š
 * node scripts/your-script.js [options]
 */

// å¯¼å…¥å¿…éœ€çš„æ¨¡å—
const fs = require('fs');
const path = require('path');

// ä¸»å‡½æ•°
async function main() {
  try {
    console.log('ğŸš€ å¼€å§‹æ‰§è¡Œä»»åŠ¡...');
    
    // ä½ çš„ä»£ç 
    
    console.log('âœ… ä»»åŠ¡å®Œæˆï¼');
  } catch (error) {
    console.error('âŒ æ‰§è¡Œå¤±è´¥ï¼š', error.message);
    process.exit(1);
  }
}

// æ‰§è¡Œ
main();
```

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [OSS é™æ€èµ„æºéƒ¨ç½²æŒ‡å—](../docs/OSS_STATIC_DEPLOYMENT.md)
- [å®Œæ•´éƒ¨ç½²æ–‡æ¡£](../../../docs/å®Œæ•´éƒ¨ç½²æ–‡æ¡£.md)
- [é¡¹ç›® README](../README.md)

---

æ›´æ–°æ—¥æœŸï¼š2025-11-27

